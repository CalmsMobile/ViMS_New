<ion-header class="transparent-header">
  <ion-toolbar class="" [ngClass]="{'active':isClassActive()}">
    <ion-title color="favorite">{{"ADD_VISITORS.TITLE" | translate}}</ion-title>
    <ion-buttons end>
        <button ion-button icon-only (click)="scanPreAppointmentQR()" style="padding: 5px;">
            <!-- <ion-icon name="contact"></ion-icon> -->
            <img item-end style="width: 30px;height: 30px;" src="../../assets/images/qrcodescan.png">
        </button>
        <button ion-button icon-only (click)="scanQrCode()" *ngIf="false" style="padding: 5px;">
            <!-- <ion-icon name="contact"></ion-icon> -->
            <img item-end style="width: 30px;height: 30px;" src="../../assets/images/qrcodescan.png">
        </button>
        <button ion-button icon-only (click)="scanOcr()" *ngIf="false" style="margin-left: 10px;padding: 5px;">
            <!-- <ion-icon name="contact"></ion-icon> -->
            <img item-end style="width: 35px;height: 35px;" src="../../assets/images/ocr.png">
        </button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content>
<div padding profile-bg [ngStyle]="{'background-image': ''}" style="height:180px">
    <ion-thumbnail *ngIf="visitorSEQID && !visitor_RemoveImg && !data.profile && !data.contact" text-center margin-top (click)= "presentActionSheet()">
      <img class="circle-pic" onError="this.src='../../assets/images/user.png';" [src]="data.logo + visitorSEQID + imageType">
    </ion-thumbnail>
    <ion-thumbnail *ngIf="!visitor_RemoveImg && data.profile" text-center margin-top (click)= "presentActionSheet()">
      <img class="circle-pic" onError="this.src='../../assets/images/user.png';" [src]="base64Image" />
    </ion-thumbnail>
    <ion-avatar *ngIf="!visitor_RemoveImg && data.contact" text-center margin-top (click)= "presentActionSheet()">
      <img onError="this.src='../../assets/images/user.png';" [src]="data.contact" class="circle-pic">
    </ion-avatar>
    <ion-avatar *ngIf="visitor_RemoveImg" text-center margin-top (click)= "presentActionSheet()">
        <img class="circle-pic" src="../../assets/images/user.png"/>
    </ion-avatar>
</div>
<ion-grid padding>
  <ion-row align-items-start>
    <form novalidate col-12 col-sm-12 col-md-12 (ngSubmit)="addVisitors()"
    [formGroup]="visitorProfile" class="simple-form">
      <ion-col no-padding col-12 col-sm-12 col-md-12 offset-lg-3 col-lg-6 offset-xl-3 col-xl-6>

          <!---Input field username-->
          <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.NameEnabled && hostSettings.NameRequired">
              <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_USER_NAME' | translate}}</ion-label>
              <ion-input no-lines required type="text" [(ngModel)]="visitorInfoModal.visitor_name"
              formControlName="username" [class.error1]="!visitorProfile.controls.username.valid && visitorProfile.controls.username.dirty"
              ></ion-input>
          </ion-item>
          <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.NameEnabled && !hostSettings.NameRequired">
              <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_USER_NAME' | translate}}</ion-label>
              <ion-input no-lines type="text" [(ngModel)]="visitorInfoModal.visitor_name"
              formControlName="username" [class.error1]="!visitorProfile.controls.username.valid && visitorProfile.controls.username.dirty"
              ></ion-input>
          </ion-item>
          <ion-item no-lines no-border no-margin transparent *ngIf="( visitorProfile.get('username').hasError('minlength') || visitorProfile.get('username').hasError('maxlength') ||visitorProfile.get('username').hasError('pattern') ||visitorProfile.get('username').hasError('required') ) && visitorProfile.get('username').touched">
            <div class="error" no-border no-margin *ngIf="visitorProfile.get('username').hasError('required') && visitorProfile.get('username').touched">
              {{'ADD_VISITORS.ERROR.USERNAME_REQUIRED' | translate}}
            </div>
            <div class="error" no-border no-margin *ngIf="visitorProfile.get('username').hasError('minlength') && visitorProfile.get('username').touched">
              {{'ADD_VISITORS.ERROR.USERNAME_MIN4' | translate}}
            </div>
            <div class="error" no-border no-margin *ngIf="visitorProfile.get('username').hasError('maxlength') && visitorProfile.get('username').touched">
              {{'ADD_VISITORS.ERROR.USERNAME_MAX20' | translate}}
            </div>
            <!-- <div class="error" *ngIf="visitorProfile.get('username').hasError('pattern') && visitorProfile.get('username').touched">
              {{'ADD_VISITORS.ERROR.USERNAME_ALPHA' | translate}}
            </div> -->
          </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.IdProofEnabled && hostSettings.IdProofRequired">
          <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_USER_IC' | translate}}</ion-label>
          <ion-input type="text" required [(ngModel)]="visitorInfoModal.visitor_ic" [disabled] = "disableIc"
          formControlName="icPassport" [class.error1]="!visitorProfile.controls.icPassport.valid && visitorProfile.controls.icPassport.dirty"
          ></ion-input>
        </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.IdProofEnabled && !hostSettings.IdProofRequired">
            <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_USER_IC' | translate}}</ion-label>
            <ion-input type="text" [(ngModel)]="visitorInfoModal.visitor_ic" [disabled] = "disableIc"
            formControlName="icPassport" [class.error1]="!visitorProfile.controls.icPassport.valid && visitorProfile.controls.icPassport.dirty"
            ></ion-input>
          </ion-item>
        <ion-item no-lines transparent no-lines *ngIf="(visitorProfile.get('icPassport').hasError('required') && visitorProfile.get('icPassport').touched)">
          <div class="error" *ngIf="visitorProfile.get('icPassport').hasError('required') && visitorProfile.get('icPassport').touched">
            {{'ADD_VISITORS.ERROR.IC_REQUIRED' | translate}}
          </div>
        </ion-item>

        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.EmailEnabled && hostSettings.EmailRequired">
            <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_E_MAIL' | translate}}</ion-label>
            <ion-input editable='false' required type="email" pattern="[a-zA-Z0-9.-_]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{2,}" required [(ngModel)]="visitorInfoModal.visitor_email"
              formControlName="email" [class.error1]="!visitorProfile.controls.email.valid && visitorProfile.controls.email.dirty"
            ></ion-input>
        </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.EmailEnabled && !hostSettings.EmailRequired">
            <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_E_MAIL' | translate}}</ion-label>
            <ion-input editable='false' type="email" pattern="[a-zA-Z0-9.-_]{1,}@[a-zA-Z.-]{2,}[.]{1}[a-zA-Z]{2,}" required [(ngModel)]="visitorInfoModal.visitor_email"
              formControlName="email" [class.error1]="!visitorProfile.controls.email.valid && visitorProfile.controls.email.dirty"
            ></ion-input>
        </ion-item>
        <ion-item no-lines transparent no-lines *ngIf="( visitorProfile.get('email').hasError('minlength') || visitorProfile.get('email').hasError('pattern') ||visitorProfile.get('email').hasError('required') ) && visitorProfile.get('email').touched">
          <div class="error" *ngIf="visitorProfile.get('email').hasError('required') && visitorProfile.get('email').touched">
              {{'ADD_VISITORS.ERROR.EMAIL_REQUIRED' | translate}}
          </div>
          <div class="error" *ngIf="visitorProfile.get('email').hasError('pattern') && visitorProfile.get('email').touched">
              {{'ADD_VISITORS.ERROR.EMAIL_PATERN' | translate}}
          </div>
        </ion-item>
        <ion-item class= "box_round_corner" no-lines no-padding transparent (click)="openVisitorCompany()" *ngIf= "hostSettings && hostSettings.CompanyEnabled">
          <ion-label style="margin-top: -20px;
          color: #8e8e93 !important;" floating>{{'ADD_VISITORS.LAB_USER_COMPANY' | translate}}</ion-label>
          <ion-icon name="arrow-forward" item-right></ion-icon>
          <ion-label *ngIf="visitorInfoModal.visitor_comp_name" style="margin-top: 30px;color: #000000!important;">{{visitorInfoModal.visitor_comp_name}} </ion-label>
        </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.CategoryEnabled && hostSettings.CategoryRequired">
          <!-- <ion-label color="favorite" floating style="font-size: 16px;margin-left: 7px;">{{'ADD_VISITORS.LAB_USER_CATE' | translate}}</ion-label> -->
          <ion-select mode="ios" interface="action-sheet" required [(ngModel)]="visitorInfoModal.visitor_ctg_name"
          interface="action-sheet" placeholder="{{'ADD_VISITORS.LAB_USER_CATE' | translate}}"
          formControlName="vistorCategory">
          <ion-label>{{'ADD_VISITORS.LAB_USER_CATE' | translate}}</ion-label>
            <ion-select-option text-left *ngFor="let vis_cat of VISITOR_CATEGORY" (ionSelect)="onChangeCategory(vis_cat)"
              [value]="vis_cat.visitor_ctg_desc" >
              {{vis_cat.visitor_ctg_desc}} <span float-right>({{vis_cat.time_permit}})</span>
            </ion-select-option>
          </ion-select>
        </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.CategoryEnabled && !hostSettings.CategoryRequired">
            <!-- <ion-label color="favorite" floating style="font-size: 16px;margin-left: 7px;">{{'ADD_VISITORS.LAB_USER_CATE' | translate}}</ion-label> -->
            <ion-select mode="ios" interface="action-sheet" [(ngModel)]="visitorInfoModal.visitor_ctg_name"
            interface="action-sheet" placeholder="{{'ADD_VISITORS.LAB_USER_CATE' | translate}}"
            formControlName="vistorCategory">
            <ion-label>{{'ADD_VISITORS.LAB_USER_CATE' | translate}}</ion-label>
              <ion-select-option text-left *ngFor="let vis_cat of VISITOR_CATEGORY" (ionSelect)="onChangeCategory(vis_cat)"
                [value]="vis_cat.visitor_ctg_desc" >
                {{vis_cat.visitor_ctg_desc}} <span float-right>({{vis_cat.time_permit}})</span>
              </ion-select-option>
            </ion-select>
          </ion-item>
          <ion-item no-lines transparent no-lines *ngIf="(visitorProfile.get('vistorCategory').hasError('required') && visitorProfile.get('vistorCategory').touched)">
              <div class="error" *ngIf="visitorProfile.get('vistorCategory').hasError('required') && visitorProfile.get('vistorCategory').touched">
                {{'ADD_VISITORS.ERROR.CATE_REQUIRED' | translate}}
              </div>
          </ion-item>

         <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.ContactNumberEnabled && hostSettings.ContactNumberRequired">
          <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_USER_CONTACT' | translate}}</ion-label>
          <ion-input type="text" required formControlName="contact" [(ngModel)]="visitorInfoModal.visitor_mobile_no"
          ></ion-input>
        </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.ContactNumberEnabled && !hostSettings.ContactNumberRequired">
            <ion-label color="favorite" floating>{{'ADD_VISITORS.LAB_USER_CONTACT' | translate}}</ion-label>
            <ion-input type="text" formControlName="contact" [(ngModel)]="visitorInfoModal.visitor_mobile_no"
            ></ion-input>
          </ion-item>
        <ion-item no-lines transparent no-lines *ngIf="(visitorProfile.get('contact').hasError('required') && visitorProfile.get('contact').touched)">
            <div class="error" *ngIf="visitorProfile.get('contact').hasError('required') && visitorProfile.get('contact').touched">
              {{'ADD_VISITORS.ERROR.CONTACT_REQUIRED' | translate}}
            </div>
        </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.VehicleNumberEnabled && hostSettings.VehicleNumberRequired">
            <ion-label color="favorite" floating>{{'ADD_APPOIN.STEP2.VECHILE_NO' | translate}}</ion-label>
            <ion-input type="text" required formControlName="vechile" [(ngModel)]="visitorInfoModal.vehicle_no"
            ></ion-input>
          </ion-item>
          <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.VehicleNumberEnabled && !hostSettings.VehicleNumberRequired">
              <ion-label color="favorite" floating>{{'ADD_APPOIN.STEP2.VECHILE_NO' | translate}}</ion-label>
              <ion-input type="text" formControlName="vechile" [(ngModel)]="visitorInfoModal.vehicle_no"
              ></ion-input>
          </ion-item>
          <ion-item no-lines transparent no-lines *ngIf="(visitorProfile.get('vechile').hasError('required') && visitorProfile.get('vechile').touched)">
              <div class="error" *ngIf="visitorProfile.get('vechile').hasError('required') && visitorProfile.get('vechile').touched">
                {{'ADD_VISITORS.ERROR.VECHILE_REQUIRED' | translate}}
              </div>
          </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.GenderEnabled && hostSettings.GenderRequired">
          <!-- <ion-label color="favorite" floating style="font-size: 16px;margin-left: 7px;">{{'ADD_VISITORS.LAB_USER_GENDER' | translate}}</ion-label> -->
          <ion-select mode="ios" interface="action-sheet" required [(ngModel)]="visitorInfoModal.visitor_gender"
          interface="action-sheet" placeholder="{{'COMMON.SELECT_GENDER' | translate}}"
          formControlName="gender">
            <ion-label>{{'COMMON.SELECT_GENDER' | translate}}</ion-label>
            <ion-select-option *ngFor="let gender of GenderList" [value]="gender.value">{{gender.name}}</ion-select-option>
          </ion-select>
        </ion-item>
        <ion-item no-lines no-padding transparent *ngIf= "hostSettings && hostSettings.GenderEnabled && !hostSettings.GenderRequired">
            <!-- <ion-label color="favorite" floating style="font-size: 16px;margin-left: 7px;">{{'ADD_VISITORS.LAB_USER_GENDER' | translate}}</ion-label> -->
            <ion-select mode="ios" interface="action-sheet" [(ngModel)]="visitorInfoModal.visitor_gender"
            interface="action-sheet" placeholder="{{'COMMON.SELECT_GENDER' | translate}}"
          formControlName="gender">
            <ion-label>{{'COMMON.SELECT_GENDER' | translate}}</ion-label>
            <ion-select-option *ngFor="let gender of GenderList" [value]="gender.value">{{gender.name}}</ion-select-option>
          </ion-select>
        </ion-item>
        <ion-item no-lines transparent no-lines *ngIf="(visitorProfile.get('gender').hasError('required') && visitorProfile.get('gender').touched)">
            <div class="error" *ngIf="visitorProfile.get('gender').hasError('required') && visitorProfile.get('gender').touched">
              {{'ADD_VISITORS.ERROR.GENDER_REQUIRED' | translate}}
            </div>
        </ion-item>

        <button *ngIf="!visitor" bottom right ion-button icon-right align-items-end round outline color="favorite"
        style="margin-left: auto;margin-top:15px; display: block;"
        type="submit" [disabled]="visitorProfile.invalid">
        <i start class="icon siva-icon-plus"> </i>{{'COMMON.ADD' | translate}}</button>
        <button *ngIf="visitor" bottom right ion-button icon-right align-items-end round outline color="favorite"
        style="margin-left: auto;margin-top:15px; display: block;"
        type="submit" [disabled]="visitorProfile.invalid">
        {{'EDIT_VISITOR.UPDATE' | translate}}</button>
      </ion-col>

      <!-- <ion-col align-self-end bottom-form col-12 col-sm-12 col-md-12 offset-lg-3 col-lg-6 offset-xl-3 col-xl-6> -->

      <!-- </ion-col> -->
    </form>
  </ion-row>
</ion-grid>
</ion-content>
