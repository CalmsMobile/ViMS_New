<!--
  Generated template for the SecurityDashBoardPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header lines="none" class="ion-no-border">
  <ion-toolbar color="primary"  lines="none" class="ion-no-border">
    <ion-icon slot="start" class="commonHeaderMyBackArrow" (click)="goBack()" name="chevron-back"
    style="font-size: x-large;color: #FFF;"></ion-icon>
    <ion-title>{{(!preAppointmentInfo || !preAppointmentInfo.SEQ_ID) ? 'Manual Check-In': 'Pre-Appointment Check-In'}}</ion-title>

    <ion-buttons slot="end" *ngIf="appSettings.addVisitor.IdImgUploadEnabled">
      <img *ngIf="appointmentInfo.visitorIDImage" src="{{appointmentInfo.visitorIDImage? appointmentInfo.visitorIDImage : '../../../assets/images/user.png'}}" style="width: 45px;height: 45px; padding: 6px;display: flex;justify-content: center">
      <ion-icon slot="end" class="headerIcon" name="id-card-sharp" (click)="capture('ID_IMAGE')"></ion-icon>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content padding class="ion-no-border">
  <div class="main" *ngIf="appSettings.addVisitor">
    <ion-grid>
      <ion-card style="margin: 0px;padding: 0px;">
        <ion-row>
          <ion-col *ngIf="appSettings.addVisitor.ImageUploadEnabled" size="3" style="display: flex;justify-content: center;align-items: center;">
            <ion-grid>
              <ion-row>
                <ion-col size="12" style="display: flex;justify-content: center;align-items: center;">
                  <img src="{{base64Image ? base64Image : (appointmentInfo.SEQ_ID ? visitorImagePath + appointmentInfo.att_visitor_id + imageURLType: '../../../assets/images/user.png')}}" style="width: 70px;height: 70px; display: flex;justify-content: center">
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="12" style="display: flex;justify-content: center;align-items: center;">
                  <ion-button expand="block" (click)="capture('PROFILE_IMAGE')">Capture</ion-button>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-col>
          <ion-col size="{{appSettings.addVisitor.ImageUploadEnabled? '9': '12'}}">
              <ion-grid>
                <ion-row *ngIf="appSettings.addVisitor.NameEnabled">
                  <ion-col size="12" class="bDets">
                    <ion-icon name="person-sharp" class="bDets"></ion-icon>
                    <input type="text" [(ngModel)]="appointmentInfo.VISITOR_NAME" placeholder="{{appSettings.addVisitor.NameLable}}"/>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="appSettings.addVisitor.IdProofEnabled">
                  <ion-col size="12" class="bDets">
                    <ion-icon name="id-card-sharp" class="bDets"></ion-icon>
                    <input type="text" (input)='onChangeID($event)' [(ngModel)]="appointmentInfo.VISITOR_IC" [disabled]="preAppointmentInfo.VISITOR_IC" placeholder="{{appSettings.addVisitor.IdProofLable}}"/>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="appSettings.addVisitor.EmailEnabled">
                  <ion-col size="12" class="bDets">
                    <ion-icon name="mail-sharp" class="bDets"></ion-icon>
                    <input type="text" [(ngModel)]="appointmentInfo.EMAIL" placeholder="{{appSettings.addVisitor.EmailLable}}"/>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="appSettings.addVisitor.ContactNumberEnabled">
                  <ion-col size="12" class="bDets">
                    <ion-icon name="phone-portrait-sharp" class="bDets"></ion-icon>
                    <input type="text" [(ngModel)]="appointmentInfo.TELEPHONE_NO" placeholder="{{appSettings.addVisitor.ContactNumberLable}}"/>
                  </ion-col>
                </ion-row>
              </ion-grid>
          </ion-col>
        </ion-row>
      </ion-card>
    </ion-grid>
    <div class="section">
      <div class="visitorInfo">
        <ion-item>
          <ion-label>Visitor Additional Information</ion-label>
        </ion-item>
        <ion-grid style="font-size: 15px;">
          <ion-row *ngIf="appSettings.addVisitor.AddressEnabled">
            <ion-col size="3">
              <ion-text>{{appSettings.addVisitor.AddressLable}}</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-textarea [(ngModel)]="appointmentInfo.VISITOR_ADDRESS" placeholder="{{appSettings.addVisitor.AddressLable}}"></ion-textarea>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="appSettings.addVisitor.CategoryEnabled">
            <ion-col size="3">
              <ion-text>{{appSettings.addVisitor.CategoryLable}}</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.VisitorCategory"
              interface="action-sheet" [disabled]="false"
              placeholder="{{appSettings.addVisitor.CategoryLable}}">
              <ion-label position="stacked">{{appSettings.addVisitor.CategoryLable}}</ion-label>
              <ion-select-option text-left *ngFor="let avl_reason of CATEGORYLIST"
                [value]="avl_reason.visitor_ctg_id">
                {{avl_reason.visitor_ctg_desc}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="appSettings.addVisitor.GenderEnabled">
            <ion-col size="3">
              <ion-text>{{appSettings.addVisitor.GenderLable}}</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.VISITOR_GENDER"
              interface="action-sheet" [disabled]="false"
              placeholder="{{appSettings.addVisitor.GenderLable}}">
              <ion-label position="stacked">{{appSettings.addVisitor.GenderLable}}</ion-label>
              <ion-select-option text-left *ngFor="let gender of GENDERLIST"
                [value]="gender.code">
                {{gender.name}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="appSettings.addVisitor.CountryEnabled">
            <ion-col size="3">
              <ion-text>{{appSettings.addVisitor.CountryLable}}</ion-text>
            </ion-col>
            <ion-col size="9">
              <!-- <input type="text" mode="ios" (ngModelChange)="onChangeInput($event, 'country')" class="inputCountry" [(ngModel)]="appointmentInfo.VISITOR_COUNTRY" placeholder="{{'ADD_VISITORS.LAB_COUNTRY' | translate}}"/> -->
              <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.VISITOR_COUNTRY"
              interface="action-sheet" [disabled]="false"
              placeholder="{{appSettings.addVisitor.CountryLable}}">
              <ion-label position="stacked">{{appSettings.addVisitor.CountryLable}}</ion-label>
              <ion-select-option text-left *ngFor="let country of COUNTRYLIST"
                [value]="country.code">
                {{country.name}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="appSettings.addVisitor.VehicleNumberEnabled">
            <ion-col size="3">
              <ion-text>{{appSettings.addVisitor.VehicleNumberLable}}</ion-text>
            </ion-col>
            <ion-col size="9">
              <input type="text" mode="ios" class="inputCountry" placeholder="{{appSettings.addVisitor.VehicleNumberLable}}" [(ngModel)]="appointmentInfo.PLATE_NUM"/>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="appSettings.addVisitor.CompanyEnabled">
            <ion-col size="3">
              <ion-text>{{appSettings.addVisitor.CompanyLable}}</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.visitor_comp_code"
              interface="action-sheet" [disabled]="false"
              placeholder="{{appSettings.addVisitor.CompanyLable}}">
              <ion-label position="stacked">{{appSettings.addVisitor.CompanyLable}}</ion-label>
              <ion-select-option text-left *ngFor="let company of COMPANYLIST"
                [value]="company.visitor_comp_code">
                {{company.visitor_comp_name}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="3">
              <ion-text style="font-size: 90%;">Temperature</ion-text>
            </ion-col>
            <ion-col size="9">
              <input type="text" mode="ios" [(ngModel)]="appointmentInfo.att_bodytemperature" class="inputCountry" placeholder="Temperature"/>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>
    <div class="section">
      <div class="appointmentInfo">
        <ion-item>
          <ion-label>Appointment Information</ion-label>
        </ion-item>
        <ion-grid style="font-size: 15px;">
          <ion-row>
            <ion-col size="3">
              <ion-text>Start Date</ion-text>
            </ion-col>
            <ion-col size="7">
              <ion-datetime displayFormat="YYYY-MM-DD HH:mm" #startDate
              [(ngModel)]="appointmentInfo.START_TIME" [disabled]="preAppointmentInfo.START_TIME"
              (ionChange)="startDate.open()" placeholder="Start Date">
              </ion-datetime>
            </ion-col>
            <ion-col size="2">
              <ion-icon name="calendar-number-outline" class="calanderinput" (click)="startDate.open()"></ion-icon>
            </ion-col>
          </ion-row>
          <!-- <ion-row>
            <ion-col size="3">
              <ion-text>Start Time</ion-text>
            </ion-col>
            <ion-col size="7">
              <ion-datetime displayFormat="hh:mm A" #startTime minuteValues="0,15,30,45" [(ngModel)]="appointmentInfo.START_TIME" (ionChange)="endDate.open()" placeholder="Start Time"></ion-datetime>
            </ion-col>
            <ion-col size="2">
              <ion-icon name="time-outline" class="calanderinput" (click)="startTime.open()"></ion-icon>
            </ion-col>
          </ion-row> -->
          <ion-row>
            <ion-col size="3">
              <ion-text>End Date</ion-text>
            </ion-col>
            <ion-col size="7">
              <ion-datetime displayFormat="YYYY-MM-DD HH:mm" #endDate
              [(ngModel)]="appointmentInfo.END_TIME" [disabled]="preAppointmentInfo.END_TIME"
              (ionChange)="endDate.open()" placeholder="End Date"></ion-datetime>
            </ion-col>
            <ion-col size="2">
              <ion-icon name="calendar-number-outline" class="calanderinput" (click)="endDate.open()"></ion-icon>
            </ion-col>
          </ion-row>
          <!-- <ion-row>
            <ion-col size="3">
              <ion-text>End Time</ion-text>
            </ion-col>
            <ion-col size="7">
              <ion-datetime displayFormat="hh:mm A" #endTime [(ngModel)]="appointmentInfo.END_TIME" minuteValues="0,15,30,45" placeholder="End Time"></ion-datetime>
            </ion-col>
            <ion-col size="2">
              <ion-icon name="time-outline" class="calanderinput" (click)="endTime.open()"></ion-icon>
            </ion-col>
          </ion-row> -->
          <ion-row>
            <ion-col size="3">
              <ion-text>Purpose</ion-text>
            </ion-col>
            <ion-col size="9">
               <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.REASON"
              interface="action-sheet" [disabled]="false"
              placeholder="{{'ADD_APPOIN.STEP2.LAB_PURPOSE' | translate}}">
              <ion-label position="stacked">{{'ADD_APPOIN.STEP2.LAB_PURPOSE' | translate}}</ion-label>
              <ion-select-option text-left *ngFor="let avl_reason of PURPOSELIST"
                [value]="avl_reason.visitpurpose_id">
                {{avl_reason.visitpurpose_desc}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="3">
              <ion-text>Host Name</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.Host_IC"
              interface="action-sheet" [disabled]="false"
              placeholder="{{'SECURITY_APP.SELECT_HOST' | translate}}">
              <ion-label position="stacked">{{'SECURITY_APP.SELECT_HOST' | translate}}</ion-label>
              <ion-select-option text-left *ngFor="let host of HOSTLIST"
                [value]="host.HOSTIC">
                {{host.HOSTNAME}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="3">
              <ion-text>Floor</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.Floor"
              interface="action-sheet" [disabled]="false"
              placeholder="{{'ADD_APPOIN.STEP2.LAB_FLOOR' | translate}}">
              <ion-label position="stacked">{{'ADD_APPOIN.STEP2.LAB_FLOOR' | translate}}</ion-label>
              <ion-select-option text-left *ngFor="let floor of FLOORLIST"
                [value]="floor.floor_id">
                {{floor.floor_desc}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="3">
              <ion-text>Meeting Location</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-select mode="ios"
              (ionChange)="onChangePurpose($event)" [(ngModel)]="appointmentInfo.MEETING_LOCATION"
              interface="action-sheet" [disabled]="false"
              placeholder="{{'ADD_APPOIN.STEP2.LAB_ROOM' | translate}}">
              <ion-label position="stacked">{{'ADD_APPOIN.STEP2.LAB_ROOM' | translate}}</ion-label>
              <ion-select-option text-left *ngFor="let meeting of MEETINGLIST"
                [value]="meeting.MeetingRoomSeqId">
                {{meeting.MeetingRoomDesc}}
              </ion-select-option>
            </ion-select>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="3">
              <ion-text>Remarks</ion-text>
            </ion-col>
            <ion-col size="9">
              <ion-textarea placeholder="Remarks" [(ngModel)]="appointmentInfo.Remarks"></ion-textarea>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>
    <div class="section">
      <div class="additional">
        <ion-item>
          <ion-label>Additional Information</ion-label>
        </ion-item>
        <ion-grid>

          <ion-card no-margin mode="ios" style="margin-top: 15px !important;
          padding: 10px;
          padding-left: 0px;" (click)="openCustomDialog('question')" *ngIf="QuestionnaireEnabled">
            <ion-item lines="none">
              <ion-icon color="primary" slot="start" name="document-text-outline"></ion-icon>
              <ion-label>Questionaries</ion-label>
              <ion-icon name="chevron-forward-outline"></ion-icon>
            </ion-item>
          </ion-card>


          <ion-card no-margin mode="ios" style="padding: 10px;margin-top: 15px !important;
          padding-left: 0px;" (click)="openCustomDialog('doc')" *ngIf="AttachmentUploadEnabled">
            <ion-item lines="none">
              <ion-icon color="primary" slot="start" name="document-attach-outline"></ion-icon>
              <ion-label>Verification Documents</ion-label>
              <ion-icon name="chevron-forward-outline"></ion-icon>
            </ion-item>
          </ion-card>

          <ion-card no-margin mode="ios" style="padding: 10px;margin-top: 15px !important;
          padding-left: 0px;" (click)="openCustomDialog('declaration')" *ngIf="MaterialDeclareEnabled">
            <ion-item lines="none">
              <ion-icon color="primary" slot="start" name="checkmark-circle-outline"></ion-icon>
              <ion-label>Item Checklist</ion-label>
              <ion-icon name="chevron-forward-outline"></ion-icon>
            </ion-item>
          </ion-card>

          <ion-row *ngIf="appSettings.addVisitor.VerificationDocEnabled">
            <ion-col size="12">
              <ion-card no-margin mode="ios" style="padding: 10px;margin-top: 15px !important;
              padding-left: 0px;" (click)="documentModal()">
                <ion-item lines="none">
                  <ion-icon color="primary" slot="start" name="document-attach-outline"></ion-icon>
                  <ion-label>Additional Document</ion-label>
                  <ion-icon name="add-circle-outline"></ion-icon>
                </ion-item>
              </ion-card>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="12">
              <ion-card no-margin mode="ios" style="padding: 10px;margin-top: 15px !important;
              padding-left: 0px;" (click)="capture('')">
                <ion-item lines="none">
                  <ion-icon color="primary" slot="start" name="checkmark-circle-outline"></ion-icon>
                  <ion-label>Item Checklist</ion-label>
                  <ion-icon name="add-circle-outline"></ion-icon>
                </ion-item>
              </ion-card>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>
    <ion-button *ngIf="appSettings.customStyle" color="transparent" class="btn-grad" [ngStyle]="{'font-size': appSettings.customStyle.buttonStyle.btnTextSize + 'px', 'border-radius': appSettings.customStyle.buttonStyle.btnBorderRadius + 'px', 'color': appSettings.customStyle.buttonStyle.btnTextColor, 'background': 'linear-gradient(to right, ' + this.appSettings.customStyle.buttonStyle.btnColor1
    +' 0%,'+ this.appSettings.customStyle.buttonStyle.btnColor2 +' 51%,'+ this.appSettings.customStyle.buttonStyle.btnColor1 +' 100%)'}" expand="block" (click)="processCheckIn()">Check-In</ion-button>
  </div>
</ion-content>
